Version 4
SHEET 1 5800 680
WIRE 2080 -288 1664 -288
WIRE 2672 -288 2080 -288
WIRE 2832 -288 2672 -288
WIRE 2672 -256 2672 -288
WIRE 1552 -208 1408 -208
WIRE 1552 -176 1552 -208
WIRE 2080 -96 2080 -288
WIRE 1104 -16 1056 -16
WIRE 1344 -16 1184 -16
WIRE 1456 -16 1344 -16
WIRE 1552 -16 1552 -96
WIRE 1552 -16 1536 -16
WIRE 1568 -16 1552 -16
WIRE 1728 -16 1648 -16
WIRE 1984 16 1952 16
WIRE 2080 16 2080 -16
WIRE 2080 16 2048 16
WIRE 2832 48 2832 -288
WIRE 1664 64 1664 -288
WIRE 656 80 16 80
WIRE 768 80 656 80
WIRE 1056 80 1056 -16
WIRE 1056 80 832 80
WIRE 1552 80 1552 -16
WIRE 1632 80 1552 80
WIRE 1728 96 1728 -16
WIRE 1728 96 1696 96
WIRE 1776 96 1728 96
WIRE 1840 96 1776 96
WIRE 1952 96 1952 16
WIRE 1952 96 1920 96
WIRE 2128 96 1952 96
WIRE 2240 96 2192 96
WIRE 2368 96 2304 96
WIRE 2512 96 2368 96
WIRE 1104 112 928 112
WIRE 1344 112 1184 112
WIRE 1456 112 1344 112
WIRE 1552 112 1536 112
WIRE 1632 112 1552 112
WIRE 16 128 16 80
WIRE 2080 128 2080 16
WIRE 2368 128 2368 96
WIRE 1552 176 1552 112
WIRE 16 272 16 208
WIRE 656 272 16 272
WIRE 768 272 656 272
WIRE 928 272 928 112
WIRE 928 272 832 272
WIRE 1408 304 1408 -208
WIRE 1472 304 1408 304
WIRE 1552 304 1552 256
WIRE 1552 304 1472 304
WIRE 2672 304 2672 -176
WIRE 2672 304 1552 304
WIRE 2672 336 2672 304
WIRE 16 352 16 272
WIRE 928 352 928 272
WIRE 1056 352 1056 80
WIRE 928 480 928 432
WIRE 1056 480 1056 432
WIRE 1056 480 928 480
WIRE 1664 480 1664 128
WIRE 1664 480 1056 480
WIRE 2080 480 2080 208
WIRE 2080 480 1664 480
WIRE 2368 480 2368 208
WIRE 2368 480 2080 480
WIRE 2672 480 2672 416
WIRE 2672 480 2368 480
WIRE 2832 480 2832 128
WIRE 2832 480 2672 480
WIRE 16 512 16 432
WIRE 928 512 928 480
FLAG 656 80 INPUT
FLAG 656 272 INPUT2
FLAG 16 512 0
FLAG 928 512 0
FLAG 1472 304 Vref
FLAG 1344 -16 -IN
FLAG 1344 112 +IN
FLAG 1776 96 OUT
FLAG 2512 96 SENSE
FLAG 2080 16 OUT_CLAMP_DIV
SYMBOL voltage 16 112 R0
WINDOW 123 0 0 Left 0
WINDOW 39 24 124 Left 2
SYMATTR SpiceLine Rser=10000
SYMATTR InstName V_LINE
SYMATTR Value PULSE(0 12 0 0 0 0.000312 0.000624)
SYMBOL voltage 16 336 R0
WINDOW 3 24 152 Left 2
WINDOW 123 24 124 Left 2
WINDOW 39 24 44 Left 2
SYMATTR Value SINE(0 230 50)
SYMATTR SpiceLine Rser=1000
SYMATTR InstName V_EARTH_REF
SYMBOL cap 832 64 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C6
SYMATTR Value 1n
SYMBOL cap 832 256 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C7
SYMATTR Value 1n
SYMBOL res 912 336 R0
SYMATTR InstName R12
SYMATTR Value 470k
SYMATTR SpiceLine tol=1
SYMBOL res 1040 336 R0
SYMATTR InstName R13
SYMATTR Value 470k
SYMATTR SpiceLine tol=1
SYMBOL voltage 2832 32 R0
WINDOW 123 0 0 Left 0
WINDOW 39 24 124 Left 2
SYMATTR SpiceLine Rser=1
SYMATTR InstName V4
SYMATTR Value 5
SYMBOL res 1552 -32 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R14
SYMATTR Value 470K
SYMATTR SpiceLine tol=5
SYMBOL res 1552 96 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R15
SYMATTR Value 470K
SYMATTR SpiceLine tol=5
SYMBOL res 1536 160 R0
SYMATTR InstName R16
SYMATTR Value 36k
SYMATTR SpiceLine tol=5
SYMBOL res 1664 -32 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R17
SYMATTR Value 470K
SYMATTR SpiceLine tol=5
SYMBOL res 1536 -192 R0
SYMATTR InstName R18
SYMATTR Value 36k
SYMATTR SpiceLine tol=5
SYMBOL res 1200 -32 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R19
SYMATTR Value 1000k
SYMATTR SpiceLine tol=5
SYMBOL res 1200 96 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R20
SYMATTR Value 1000k
SYMATTR SpiceLine tol=5
SYMBOL res 2656 -272 R0
SYMATTR InstName R1
SYMATTR Value 10k
SYMATTR SpiceLine tol=1
SYMBOL res 2656 320 R0
SYMATTR InstName R2
SYMATTR Value 10k
SYMATTR SpiceLine tol=1
SYMBOL res 2064 -112 R0
SYMATTR InstName R3
SYMATTR Value 10k
SYMATTR SpiceLine tol=1
SYMBOL res 2064 112 R0
SYMATTR InstName R4
SYMATTR Value 100k
SYMATTR SpiceLine tol=1
SYMBOL diode 1984 32 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D1
SYMATTR Value 1N4148
SYMBOL OpAmps\\OP07 1664 32 R0
SYMATTR InstName U1
SYMBOL res 1936 80 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value 1k
SYMATTR SpiceLine tol=1
SYMBOL diode 2128 112 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D2
SYMATTR Value 1N4148
SYMBOL res 2352 112 R0
SYMATTR InstName R6
SYMATTR Value 100k
SYMATTR SpiceLine tol=1
SYMBOL diode 2240 112 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D3
SYMATTR Value 1N4148
TEXT -16 296 Left 2 !.tran 10ms
